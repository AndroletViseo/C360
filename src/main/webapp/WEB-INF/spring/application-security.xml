<b:beans xmlns="http://www.springframework.org/schema/security"
         xmlns:b="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:security="http://www.springframework.org/schema/c"
         xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">

    <!--
    <http pattern="/api/collaborateurs*" security="none"/>
    <http use-expressions="false" authentication-manager-ref="authenticationManager">
        <intercept-url pattern='/api/**' access='ROLE_USER' />
        <form-login login-page='/index.html' default-target-url='/index.html' always-use-default-target='true' />
        <csrf disabled="true"/>
    </http>


    <authentication-manager id="authenticationManager">
        <authentication-provider user-service-ref="myUserDetailsService">
        </authentication-provider>
    </authentication-manager>

    <user-service id="myUserDetailsService">
      <user name="user" password="password" authorities="ROLE_USER" />
    </user-service>
    -->

    <!--
    <global-method-security pre-post-annotations="enabled" />
-->


    <b:bean id="restAuthenticationEntryPoint" name="restAuthenticationEntryPoint"
            class="com.viseo.c360.formation.security.RestAuthenticationEntryPoint"/>
    <b:bean id="jwtAuthenticationProvider" name="jwtAuthenticationProvider"
            class="com.viseo.c360.formation.security.JwtAuthenticationProvider"/>
    <b:bean id="jwtAuthenticationSuccessHandler" name="jwtAuthenticationSuccessHandler"
            class="com.viseo.c360.formation.security.JwtAuthenticationSuccessHandler"/>
    <b:bean id="jwtUtil" name="jwtUtil" class="com.viseo.c360.formation.security.JwtUtil"/>


    <http pattern="/api/user" security="none"/>
    <http pattern="/api/collaborateurs" security="none"/>
    <http pattern="/api/**" entry-point-ref="restAuthenticationEntryPoint" create-session="stateless">
        <csrf disabled="true"/>
        <custom-filter before="FORM_LOGIN_FILTER" ref="jwtAuthenticationFilter"/>
    </http>

    <b:bean id="jwtAuthenticationFilter" name="jwtAuthenticationFilter"
            class="com.viseo.c360.formation.security.JwtAuthenticationFilter">
        <b:property name="authenticationManager" ref="authenticationManager"/>
        <b:property name="authenticationSuccessHandler" ref="jwtAuthenticationSuccessHandler"/>
    </b:bean>

    <authentication-manager alias="authenticationManager">
        <authentication-provider ref="jwtAuthenticationProvider"/>
    </authentication-manager>

</b:beans>