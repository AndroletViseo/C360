<b:beans xmlns="http://www.springframework.org/schema/security"
         xmlns:b="http://www.springframework.org/schema/beans"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:security="http://www.springframework.org/schema/c"
         xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						http://www.springframework.org/schema/security http://www.springframework.org/schema/security/spring-security.xsd">


    <b:bean id="restAuthenticationEntryPoint" name="restAuthenticationEntryPoint"
            class="com.viseo.c360.formation.security.RestAuthenticationEntryPoint"/>
    <b:bean id="jwtAuthenticationProvider" name="jwtAuthenticationProvider"
            class="com.viseo.c360.formation.security.JwtAuthenticationProvider"/>
    <b:bean id="jwtAuthenticationSuccessHandler" name="jwtAuthenticationSuccessHandler"
            class="com.viseo.c360.formation.security.JwtAuthenticationSuccessHandler"/>
    <b:bean id="jwtUtil" name="jwtUtil" class="com.viseo.c360.formation.security.JwtUtil"/>

    <b:bean id="jwtAuthenticationFilter" name="jwtAuthenticationFilter"
            class="com.viseo.c360.formation.security.JwtAuthenticationFilter">
        <b:property name="authenticationManager" ref="authenticationManager"/>
        <b:property name="authenticationSuccessHandler" ref="jwtAuthenticationSuccessHandler"/>
    </b:bean>

    <authentication-manager alias="authenticationManager">
        <authentication-provider ref="jwtAuthenticationProvider"/>
    </authentication-manager>


    <http pattern="/api/login" security="none"/>
    <http pattern="/api/logout" security="none"/>
    <http pattern="/api/signup" security="none"/>

    <http pattern="/api/**" entry-point-ref="restAuthenticationEntryPoint" create-session="stateless">
        <intercept-url pattern="/api/admin/**"  access="ROLE_ADMIN"></intercept-url>
        <csrf disabled="true"/>
        <custom-filter before="FORM_LOGIN_FILTER" ref="jwtAuthenticationFilter"/>
    </http>

</b:beans>